!function(){"use strict";var e={};function t(e,t,n,o,c,r,i){try{var a=e[r](i),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(o,c)}e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var n=window.regeneratorRuntime,o=e.n(n),c=window.wp.apiFetch,r=e.n(c),i=window.wp.i18n,a=function(e,t){e?(t.classList.add("hidden"),t.setAttribute("aria-hidden","true")):(t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"))};document.querySelector("#icw-fix-content-btn").addEventListener("click",function(){var e,n=(e=o().mark((function e(t){var n,c,u,s,d,l,p,f,w,v,y,h,m,b,S,q,_;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=document.querySelector("#icw-post-selection").value,c=document.querySelector("#icw-post-ids").value,u=document.querySelector("#icw-post-type").value,s=+document.querySelector("#icw-batch-size").value,d=document.querySelector("#icw-dry-run").checked,l=document.querySelector("#icw-fix-log"),p=document.querySelector("#icw-loading-spinner"),f=document.querySelector("#icw-fix-content-btn"),v=function(e){e?f.setAttribute("disabled",""):f.removeAttribute("disabled")},y=function(e){l.innerHTML=e,l.scrollTop=l.scrollHeight},(w=function(){p.classList.toggle("hidden"),p.setAttribute("aria-hidden","true")})(),v(!0),y(""),a(!0,l),e.next=18,r()({path:"/icw/v1/count-for-fix",method:"POST",data:{postSelection:n,postIds:"posts"===n&&c,postType:"all_from_post_type"===n?u:"",batchSize:s}});case 18:h=e.sent,m=Math.ceil(h/s),a(!1,l),y((b=function(e,t,n,o){var c=e>0?Math.ceil(100/t*e):0,r=50*c/100,a=e!==t?n*e:o;return"<span>[".concat("#".repeat(r)).concat("-".repeat(50-r),"] | ").concat(c,"% || ").concat(a,"/").concat(o," ").concat((0,i.__)("posts","insecure-content-warning"),"</span>")})(0,m,s,h)),S="",q=1;case 25:if(!(q<=m)){e.next=34;break}return e.next=28,r()({path:"/icw/v1/fix",method:"POST",data:{postSelection:n,postIds:"posts"===n&&c,postType:"all_from_post_type"===n?u:"",batchSize:s,offset:(q-1)*s,dryRun:d}});case 28:_=e.sent,y((S+=_)+b(q,m,s,h));case 31:q++,e.next=25;break;case 34:w(),v(!1);case 36:case"end":return e.stop()}}),e)})),function(){var n=this,o=arguments;return new Promise((function(c,r){var i=e.apply(n,o);function a(e){t(i,c,r,a,u,"next",e)}function u(e){t(i,c,r,a,u,"throw",e)}a(void 0)}))});return function(_x){return n.apply(this,arguments)}}()),document.querySelector("#icw-post-selection").addEventListener("change",(function(){var e=function(e){var t=document.querySelector("#icw-post-ids-row");a(e,t)},t=function(e){var t=document.querySelector("#icw-post-type-row");a(e,t)};switch(document.querySelector("#icw-post-selection").value){case"all":e(!0),t(!0);break;case"posts":e(!1),t(!0);break;case"all_from_post_type":t(!1),e(!0)}}))}();